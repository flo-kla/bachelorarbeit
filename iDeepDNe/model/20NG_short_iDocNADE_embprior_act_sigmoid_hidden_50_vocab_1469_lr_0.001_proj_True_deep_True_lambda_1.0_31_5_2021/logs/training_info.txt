Step: 500,    val PPL: 861.7879028320312,     best val PPL: 861.7879028320312,    best val loss: 417.00787353515625
Step: 500,    val IR: 0.13038234583242797,    best val IR: 0.13038234583242797
Step: 1000,    val PPL: 837.4901123046875,     best val PPL: 837.4901123046875,    best val loss: 413.2334289550781
Step: 1000,    val IR: 0.1642199886231305,    best val IR: 0.1642199886231305
Step: 1500,    val PPL: 818.7554931640625,     best val PPL: 818.7554931640625,    best val loss: 411.85552978515625
Step: 1500,    val IR: 0.19090192210506302,    best val IR: 0.19090192210506302
Step: 2000,    val PPL: 762.001220703125,     best val PPL: 762.001220703125,    best val loss: 405.55908203125
Step: 2000,    val IR: 0.19666604004365215,    best val IR: 0.19666604004365215
Step: 2500,    val PPL: 744.7372436523438,     best val PPL: 744.7372436523438,    best val loss: 402.56109619140625
Step: 2500,    val IR: 0.20004492154598458,    best val IR: 0.20004492154598458
Step: 3000,    val PPL: 730.8705444335938,     best val PPL: 730.8705444335938,    best val loss: 399.73492431640625
Step: 3000,    val IR: 0.21354824061347216,    best val IR: 0.21354824061347216
Step: 3500,    val PPL: 702.7137451171875,     best val PPL: 702.7137451171875,    best val loss: 396.16229248046875
Step: 3500,    val IR: 0.21079435453353612,    best val IR: 0.21354824061347216
Step: 4000,    val PPL: 678.7173461914062,     best val PPL: 678.7173461914062,    best val loss: 393.39324951171875
Step: 4000,    val IR: 0.23175855645588525,    best val IR: 0.23175855645588525
Step: 4500,    val PPL: 660.41015625,     best val PPL: 660.41015625,    best val loss: 391.4039306640625
Step: 4500,    val IR: 0.24383122193929246,    best val IR: 0.24383122193929246
Step: 5000,    val PPL: 641.7054443359375,     best val PPL: 641.7054443359375,    best val loss: 389.5056457519531
Step: 5000,    val IR: 0.2518804793910202,    best val IR: 0.2518804793910202
Step: 5500,    val PPL: 630.9617919921875,     best val PPL: 630.9617919921875,    best val loss: 388.0648193359375
Step: 5500,    val IR: 0.26150199095221477,    best val IR: 0.26150199095221477
Step: 6000,    val PPL: 622.5582275390625,     best val PPL: 622.5582275390625,    best val loss: 386.767578125
Step: 6000,    val IR: 0.27181685681013107,    best val IR: 0.27181685681013107
Step: 6500,    val PPL: 608.0567626953125,     best val PPL: 608.0567626953125,    best val loss: 385.44427490234375
Step: 6500,    val IR: 0.2860452682231333,    best val IR: 0.2860452682231333
Step: 7000,    val PPL: 596.63818359375,     best val PPL: 596.63818359375,    best val loss: 383.8883056640625
Step: 7000,    val IR: 0.28954621914390233,    best val IR: 0.28954621914390233
Step: 7500,    val PPL: 591.77978515625,     best val PPL: 591.77978515625,    best val loss: 383.162353515625
Step: 7500,    val IR: 0.28841829771754607,    best val IR: 0.28954621914390233
Step: 8000,    val PPL: 590.894287109375,     best val PPL: 590.894287109375,    best val loss: 383.09112548828125
Step: 8000,    val IR: 0.3045973784371696,    best val IR: 0.3045973784371696
Step: 8500,    val PPL: 577.042724609375,     best val PPL: 577.042724609375,    best val loss: 381.53643798828125
Step: 8500,    val IR: 0.30167015378305334,    best val IR: 0.3045973784371696
Step: 9000,    val PPL: 573.425537109375,     best val PPL: 573.425537109375,    best val loss: 380.85174560546875
Step: 9000,    val IR: 0.3045509920581646,    best val IR: 0.3045973784371696
Step: 9500,    val PPL: 567.5355224609375,     best val PPL: 567.5355224609375,    best val loss: 380.0592041015625
Step: 9500,    val IR: 0.3166456300368892,    best val IR: 0.3166456300368892
Step: 10000,    val PPL: 563.29736328125,     best val PPL: 563.29736328125,    best val loss: 379.4700927734375
Step: 10000,    val IR: 0.3127198775399597,    best val IR: 0.3166456300368892
Step: 10000,    test PPL: 632.4222412109375,    best test PPL: 632.4222412109375,    best test loss: 379.2118225097656
Step: 10500,    val PPL: 569.0181884765625,     best val PPL: 563.29736328125,    best val loss: 379.4700927734375
Step: 10500,    val IR: 0.31873545848052953,    best val IR: 0.31873545848052953
Step: 11000,    val PPL: 550.6417846679688,     best val PPL: 550.6417846679688,    best val loss: 378.28125
Step: 11000,    val IR: 0.3251587512786776,    best val IR: 0.3251587512786776
Step: 11500,    val PPL: 542.9879150390625,     best val PPL: 542.9879150390625,    best val loss: 377.4121398925781
Step: 11500,    val IR: 0.32048837532928265,    best val IR: 0.3251587512786776
Step: 12000,    val PPL: 536.0054931640625,     best val PPL: 536.0054931640625,    best val loss: 376.84588623046875
Step: 12000,    val IR: 0.3295044225750302,    best val IR: 0.3295044225750302
Step: 12500,    val PPL: 531.8209838867188,     best val PPL: 531.8209838867188,    best val loss: 375.4852600097656
Step: 12500,    val IR: 0.3311743322192463,    best val IR: 0.3311743322192463
Step: 13000,    val PPL: 521.8033447265625,     best val PPL: 521.8033447265625,    best val loss: 374.642578125
Step: 13000,    val IR: 0.33055177818521897,    best val IR: 0.3311743322192463
Step: 13500,    val PPL: 523.6689453125,     best val PPL: 521.8033447265625,    best val loss: 374.642578125
Step: 13500,    val IR: 0.34112787259859056,    best val IR: 0.34112787259859056
Step: 14000,    val PPL: 517.0748291015625,     best val PPL: 517.0748291015625,    best val loss: 374.12713623046875
Step: 14000,    val IR: 0.34071283657590384,    best val IR: 0.34112787259859056
Step: 14500,    val PPL: 508.5560607910156,     best val PPL: 508.5560607910156,    best val loss: 372.64227294921875
Step: 14500,    val IR: 0.34542227473919956,    best val IR: 0.34542227473919956
Step: 15000,    val PPL: 509.58819580078125,     best val PPL: 508.5560607910156,    best val loss: 372.64227294921875
Step: 15000,    val IR: 0.3393578660312544,    best val IR: 0.34542227473919956
Step: 15500,    val PPL: 503.21832275390625,     best val PPL: 503.21832275390625,    best val loss: 372.5565185546875
Step: 15500,    val IR: 0.34862537627898293,    best val IR: 0.34862537627898293
Step: 16000,    val PPL: 497.5385437011719,     best val PPL: 497.5385437011719,    best val loss: 371.23297119140625
Step: 16000,    val IR: 0.34621084318230044,    best val IR: 0.34862537627898293
Step: 16500,    val PPL: 496.0154724121094,     best val PPL: 496.0154724121094,    best val loss: 370.8592529296875
Step: 16500,    val IR: 0.34894275676691805,    best val IR: 0.34894275676691805
Step: 17000,    val PPL: 504.0514831542969,     best val PPL: 496.0154724121094,    best val loss: 370.8592529296875
Step: 17000,    val IR: 0.3532469244610031,    best val IR: 0.3532469244610031
Step: 17500,    val PPL: 487.6058349609375,     best val PPL: 487.6058349609375,    best val loss: 369.5426025390625
Step: 17500,    val IR: 0.35795147984756026,    best val IR: 0.35795147984756026
Step: 18000,    val PPL: 485.7414855957031,     best val PPL: 485.7414855957031,    best val loss: 369.5426025390625
Step: 18000,    val IR: 0.3555247398090347,    best val IR: 0.35795147984756026
Step: 18500,    val PPL: 488.9053649902344,     best val PPL: 485.7414855957031,    best val loss: 369.5426025390625
Step: 18500,    val IR: 0.36002177718424994,    best val IR: 0.36002177718424994
Step: 19000,    val PPL: 481.45599365234375,     best val PPL: 481.45599365234375,    best val loss: 368.57513427734375
Step: 19000,    val IR: 0.35509261406776776,    best val IR: 0.36002177718424994
Step: 19500,    val PPL: 473.88275146484375,     best val PPL: 473.88275146484375,    best val loss: 367.6838684082031
Step: 19500,    val IR: 0.3550242551934436,    best val IR: 0.36002177718424994
Step: 20000,    val PPL: 472.33697509765625,     best val PPL: 472.33697509765625,    best val loss: 367.318603515625
Step: 20000,    val IR: 0.3595457064523446,    best val IR: 0.36002177718424994
Step: 20000,    test PPL: 598.0687255859375,    best test PPL: 598.0687255859375,    best test loss: 375.7330627441406
Step: 20500,    val PPL: 500.633056640625,     best val PPL: 472.33697509765625,    best val loss: 367.318603515625
Step: 20500,    val IR: 0.36572974319035745,    best val IR: 0.36572974319035745
Step: 21000,    val PPL: 474.89166259765625,     best val PPL: 472.33697509765625,    best val loss: 367.318603515625
Step: 21000,    val IR: 0.36204324675356336,    best val IR: 0.36572974319035745
Step: 21500,    val PPL: 468.95928955078125,     best val PPL: 468.95928955078125,    best val loss: 367.0472412109375
Step: 21500,    val IR: 0.36227273726022596,    best val IR: 0.36572974319035745
Step: 22000,    val PPL: 464.9853515625,     best val PPL: 464.9853515625,    best val loss: 366.70416259765625
Step: 22000,    val IR: 0.368715561165324,    best val IR: 0.368715561165324
Step: 22500,    val PPL: 464.2859191894531,     best val PPL: 464.2859191894531,    best val loss: 366.5904235839844
Step: 22500,    val IR: 0.3654709560232708,    best val IR: 0.368715561165324
Step: 23000,    val PPL: 457.67291259765625,     best val PPL: 457.67291259765625,    best val loss: 365.55413818359375
Step: 23000,    val IR: 0.36644506998239806,    best val IR: 0.368715561165324
Step: 23500,    val PPL: 453.111572265625,     best val PPL: 453.111572265625,    best val loss: 364.4593505859375
Step: 23500,    val IR: 0.3652683207886663,    best val IR: 0.368715561165324
Step: 24000,    val PPL: 460.47979736328125,     best val PPL: 453.111572265625,    best val loss: 364.4593505859375
Step: 24000,    val IR: 0.35671613733297913,    best val IR: 0.368715561165324
Step: 24500,    val PPL: 455.0128173828125,     best val PPL: 453.111572265625,    best val loss: 364.4593505859375
Step: 24500,    val IR: 0.36777074386662273,    best val IR: 0.368715561165324
Step: 25000,    val PPL: 448.6235656738281,     best val PPL: 448.6235656738281,    best val loss: 363.8838806152344
Step: 25000,    val IR: 0.36672094686806445,    best val IR: 0.368715561165324
Step: 25500,    val PPL: 451.308837890625,     best val PPL: 447.3729248046875,    best val loss: 363.8003234863281
Step: 25500,    val IR: 0.37203584934680706,    best val IR: 0.37203584934680706
Step: 26000,    val PPL: 449.7301025390625,     best val PPL: 445.3198547363281,    best val loss: 363.28912353515625
Step: 26000,    val IR: 0.36839085651228165,    best val IR: 0.37203584934680706
Step: 26500,    val PPL: 440.8584899902344,     best val PPL: 440.8584899902344,    best val loss: 362.8680419921875
Step: 26500,    val IR: 0.36774877137130274,    best val IR: 0.37203584934680706
Step: 27000,    val PPL: 445.4031982421875,     best val PPL: 440.8584899902344,    best val loss: 362.7752685546875
Step: 27000,    val IR: 0.3717404413541894,    best val IR: 0.37203584934680706
Step: 27500,    val PPL: 443.4057312011719,     best val PPL: 439.616455078125,    best val loss: 362.63336181640625
Step: 27500,    val IR: 0.3660690961736119,    best val IR: 0.37203584934680706
Step: 28000,    val PPL: 444.0405578613281,     best val PPL: 437.553466796875,    best val loss: 362.1017150878906
Step: 28000,    val IR: 0.36669653298437793,    best val IR: 0.37203584934680706
Step: 28500,    val PPL: 436.65325927734375,     best val PPL: 435.3883361816406,    best val loss: 361.8661193847656
Step: 28500,    val IR: 0.36672338825643425,    best val IR: 0.37203584934680706
Step: 29000,    val PPL: 437.12030029296875,     best val PPL: 432.44415283203125,    best val loss: 361.30029296875
Step: 29000,    val IR: 0.3675827569622292,    best val IR: 0.37203584934680706
Step: 29500,    val PPL: 441.1273498535156,     best val PPL: 431.19354248046875,    best val loss: 361.08416748046875
Step: 29500,    val IR: 0.366418214710342,    best val IR: 0.37203584934680706
Step: 30000,    val PPL: 432.7543029785156,     best val PPL: 429.1024169921875,    best val loss: 360.6787109375
Step: 30000,    val IR: 0.37051486439308307,    best val IR: 0.37203584934680706
Step: 30000,    test PPL: 596.4550170898438,    best test PPL: 596.4550170898438,    best test loss: 375.7330627441406
Step: 30500,    val PPL: 456.29248046875,     best val PPL: 427.38116455078125,    best val loss: 360.52203369140625
Step: 30500,    val IR: 0.36886692724418546,    best val IR: 0.37203584934680706
Step: 31000,    val PPL: 438.72943115234375,     best val PPL: 427.38116455078125,    best val loss: 360.52203369140625
Step: 31000,    val IR: 0.36713110011401245,    best val IR: 0.37203584934680706
Step: 31500,    val PPL: 433.72039794921875,     best val PPL: 427.38116455078125,    best val loss: 360.52203369140625
Step: 31500,    val IR: 0.36905735553694674,    best val IR: 0.37203584934680706
Step: 32000,    val PPL: 431.04302978515625,     best val PPL: 427.38116455078125,    best val loss: 360.52203369140625
Step: 32000,    val IR: 0.3684177117843374,    best val IR: 0.37203584934680706
Step: 32500,    val PPL: 429.57147216796875,     best val PPL: 424.00885009765625,    best val loss: 360.02423095703125
Step: 32500,    val IR: 0.37201143546311993,    best val IR: 0.37203584934680706
Step: 33000,    val PPL: 428.48651123046875,     best val PPL: 421.1429443359375,    best val loss: 359.524658203125
Step: 33000,    val IR: 0.3683884151239127,    best val IR: 0.37203584934680706
Step: 33500,    val PPL: 430.0068359375,     best val PPL: 419.31500244140625,    best val loss: 359.19879150390625
Step: 33500,    val IR: 0.36791478578037823,    best val IR: 0.37203584934680706
Step: 34000,    val PPL: 418.91497802734375,     best val PPL: 418.8255615234375,    best val loss: 359.19879150390625
Step: 34000,    val IR: 0.36658667050778404,    best val IR: 0.37203584934680706
Step: 34500,    val PPL: 421.5970153808594,     best val PPL: 415.01324462890625,    best val loss: 358.5982666015625
Step: 34500,    val IR: 0.3691501282949583,    best val IR: 0.37203584934680706
Step: 35000,    val PPL: 422.5084533691406,     best val PPL: 413.15008544921875,    best val loss: 358.32080078125
Step: 35000,    val IR: 0.36889866529297866,    best val IR: 0.37203584934680706
Step: 35500,    val PPL: 416.40753173828125,     best val PPL: 411.0853271484375,    best val loss: 357.9826965332031
Step: 35500,    val IR: 0.36939426713183277,    best val IR: 0.37203584934680706
Step: 36000,    val PPL: 421.2357482910156,     best val PPL: 410.74505615234375,    best val loss: 357.9226379394531
Step: 36000,    val IR: 0.3662814969616925,    best val IR: 0.37203584934680706
Step: 36500,    val PPL: 413.3038330078125,     best val PPL: 410.4078369140625,    best val loss: 357.9226379394531
Step: 36500,    val IR: 0.3675998466808111,    best val IR: 0.37203584934680706
Step: 37000,    val PPL: 422.07000732421875,     best val PPL: 408.2247009277344,    best val loss: 357.5954895019531
Step: 37000,    val IR: 0.3678220130223659,    best val IR: 0.37203584934680706
Step: 37500,    val PPL: 419.0552978515625,     best val PPL: 406.9741516113281,    best val loss: 357.30596923828125
Step: 37500,    val IR: 0.3677072677690347,    best val IR: 0.37203584934680706
Step: 38000,    val PPL: 412.09259033203125,     best val PPL: 404.6827392578125,    best val loss: 357.03924560546875
Step: 38000,    val IR: 0.3643430345969149,    best val IR: 0.37203584934680706
Step: 38500,    val PPL: 416.0575256347656,     best val PPL: 402.99755859375,    best val loss: 356.7188415527344
Step: 38500,    val IR: 0.3673190870184059,    best val IR: 0.37203584934680706
Step: 39000,    val PPL: 411.6192626953125,     best val PPL: 402.418212890625,    best val loss: 356.4898376464844
Step: 39000,    val IR: 0.368427477337812,    best val IR: 0.37203584934680706
Step: 39500,    val PPL: 408.5602111816406,     best val PPL: 400.349609375,    best val loss: 356.2199401855469
Step: 39500,    val IR: 0.3664890149730346,    best val IR: 0.37203584934680706
Step: 40000,    val PPL: 410.89617919921875,     best val PPL: 398.6103820800781,    best val loss: 355.9146728515625
Step: 40000,    val IR: 0.36900608638120336,    best val IR: 0.37203584934680706
Step: 40000,    test PPL: 592.7523193359375,    best test PPL: 592.7523193359375,    best test loss: 375.4842529296875
Step: 40500,    val PPL: 437.5955810546875,     best val PPL: 398.14581298828125,    best val loss: 355.8541259765625
Step: 40500,    val IR: 0.3669040509957198,    best val IR: 0.37203584934680706
Step: 41000,    val PPL: 412.4801940917969,     best val PPL: 398.14581298828125,    best val loss: 355.8541259765625
Step: 41000,    val IR: 0.369262432159921,    best val IR: 0.37203584934680706
Step: 41500,    val PPL: 416.499267578125,     best val PPL: 398.14581298828125,    best val loss: 355.8541259765625
Step: 41500,    val IR: 0.36297585711042124,    best val IR: 0.37203584934680706
Step: 42000,    val PPL: 404.97369384765625,     best val PPL: 398.14581298828125,    best val loss: 355.8541259765625
Step: 42000,    val IR: 0.36746312893216093,    best val IR: 0.37203584934680706
Step: 42500,    val PPL: 412.7749938964844,     best val PPL: 397.48870849609375,    best val loss: 355.7991027832031
Step: 42500,    val IR: 0.3663327661174356,    best val IR: 0.37203584934680706
Step: 43000,    val PPL: 405.98724365234375,     best val PPL: 395.98028564453125,    best val loss: 355.559326171875
Step: 43000,    val IR: 0.36702856180252635,    best val IR: 0.37203584934680706
Step: 43500,    val PPL: 403.25567626953125,     best val PPL: 394.00927734375,    best val loss: 355.32080078125
Step: 43500,    val IR: 0.36352272810501907,    best val IR: 0.37203584934680706
Step: 44000,    val PPL: 402.3796691894531,     best val PPL: 392.3251647949219,    best val loss: 355.32080078125
Step: 44000,    val IR: 0.3655808184998644,    best val IR: 0.37203584934680706
Step: 44500,    val PPL: 400.3116149902344,     best val PPL: 391.1168212890625,    best val loss: 354.885498046875
Step: 44500,    val IR: 0.3643308276550712,    best val IR: 0.37203584934680706
Step: 45000,    val PPL: 401.1101379394531,     best val PPL: 389.6578674316406,    best val loss: 354.61517333984375
Step: 45000,    val IR: 0.36792943411058987,    best val IR: 0.37203584934680706
Step: 45500,    val PPL: 399.30596923828125,     best val PPL: 388.01861572265625,    best val loss: 354.295166015625
Step: 45500,    val IR: 0.36682592656792,    best val IR: 0.37203584934680706
Step: 46000,    val PPL: 407.5223693847656,     best val PPL: 387.4715576171875,    best val loss: 354.23077392578125
Step: 46000,    val IR: 0.3672678178626618,    best val IR: 0.37203584934680706
Step: 46500,    val PPL: 394.2510986328125,     best val PPL: 386.2294921875,    best val loss: 354.120849609375
Step: 46500,    val IR: 0.36443092457818893,    best val IR: 0.37203584934680706
Step: 47000,    val PPL: 396.89215087890625,     best val PPL: 383.9248962402344,    best val loss: 353.6125793457031
Step: 47000,    val IR: 0.3639963574485538,    best val IR: 0.37203584934680706
Step: 47500,    val PPL: 397.68505859375,     best val PPL: 383.79345703125,    best val loss: 353.58367919921875
Step: 47500,    val IR: 0.36512183748654164,    best val IR: 0.37203584934680706
Step: 48000,    val PPL: 402.436279296875,     best val PPL: 382.30126953125,    best val loss: 353.4266357421875
Step: 48000,    val IR: 0.36267556634106646,    best val IR: 0.37203584934680706
Step: 48500,    val PPL: 393.01373291015625,     best val PPL: 382.30126953125,    best val loss: 353.4266357421875
Step: 48500,    val IR: 0.361601355458823,    best val IR: 0.37203584934680706
Step: 49000,    val PPL: 393.536376953125,     best val PPL: 379.8656005859375,    best val loss: 353.00274658203125
Step: 49000,    val IR: 0.3644480142967699,    best val IR: 0.37203584934680706
Step: 49500,    val PPL: 394.9127502441406,     best val PPL: 378.9781494140625,    best val loss: 352.85919189453125
Step: 49500,    val IR: 0.36479957422186887,    best val IR: 0.37203584934680706
Step: 50000,    val PPL: 390.52386474609375,     best val PPL: 378.9781494140625,    best val loss: 352.85919189453125
Step: 50000,    val IR: 0.3653317968862531,    best val IR: 0.37203584934680706
Step: 50000,    test PPL: 603.8990478515625,    best test PPL: 592.7523193359375,    best test loss: 375.4842529296875
