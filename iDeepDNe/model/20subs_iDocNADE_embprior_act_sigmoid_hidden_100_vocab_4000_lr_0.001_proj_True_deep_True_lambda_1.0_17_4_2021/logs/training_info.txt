Step: 500,    val PPL: 1367.3941650390625,     best val PPL: 1367.3941650390625,    best val loss: 95.06754302978516
Step: 500,    val IR: 0.09286243992641943,    best val IR: 0.09286243992641943
Step: 1000,    val PPL: 1195.398193359375,     best val PPL: 1195.398193359375,    best val loss: 93.24209594726562
Step: 1000,    val IR: 0.09583361423852291,    best val IR: 0.09583361423852291
Step: 1500,    val PPL: 1175.2275390625,     best val PPL: 1175.2275390625,    best val loss: 93.00559997558594
Step: 1500,    val IR: 0.0997052903275519,    best val IR: 0.0997052903275519
Step: 2000,    val PPL: 1170.643798828125,     best val PPL: 1159.642822265625,    best val loss: 92.84915161132812
Step: 2000,    val IR: 0.10093565505484908,    best val IR: 0.10093565505484908
Step: 2500,    val PPL: 1155.954345703125,     best val PPL: 1106.4208984375,    best val loss: 92.07858276367188
Step: 2500,    val IR: 0.10004478431297062,    best val IR: 0.10093565505484908
Step: 3000,    val PPL: 1210.1610107421875,     best val PPL: 1070.408203125,    best val loss: 91.5168685913086
Step: 3000,    val IR: 0.10155444905664103,    best val IR: 0.10155444905664103
Step: 3500,    val PPL: 1186.1478271484375,     best val PPL: 1036.2314453125,    best val loss: 90.89004516601562
Step: 3500,    val IR: 0.1027342508499394,    best val IR: 0.1027342508499394
Step: 4000,    val PPL: 1155.689208984375,     best val PPL: 1018.4764404296875,    best val loss: 90.75257873535156
Step: 4000,    val IR: 0.10635552002773772,    best val IR: 0.10635552002773772
Step: 4500,    val PPL: 1105.5206298828125,     best val PPL: 1007.551025390625,    best val loss: 90.68501281738281
Step: 4500,    val IR: 0.10620142346698061,    best val IR: 0.10635552002773772
Step: 5000,    val PPL: 1120.817138671875,     best val PPL: 1004.5601806640625,    best val loss: 90.68501281738281
Step: 5000,    val IR: 0.10761718561893893,    best val IR: 0.10761718561893893
Step: 5500,    val PPL: 1105.020263671875,     best val PPL: 1004.5601806640625,    best val loss: 90.68501281738281
Step: 5500,    val IR: 0.11286369196097552,    best val IR: 0.11286369196097552
Step: 6000,    val PPL: 1079.6744384765625,     best val PPL: 1001.510986328125,    best val loss: 90.68501281738281
Step: 6000,    val IR: 0.11552426539280228,    best val IR: 0.11552426539280228
Step: 6500,    val PPL: 1056.669189453125,     best val PPL: 973.9227294921875,    best val loss: 90.30623626708984
Step: 6500,    val IR: 0.11981729926515249,    best val IR: 0.11981729926515249
Step: 7000,    val PPL: 1073.9566650390625,     best val PPL: 959.5921630859375,    best val loss: 90.11668395996094
Step: 7000,    val IR: 0.12177480713852395,    best val IR: 0.12177480713852395
Step: 7500,    val PPL: 1061.611572265625,     best val PPL: 947.6492919921875,    best val loss: 89.92991638183594
Step: 7500,    val IR: 0.12113193554911408,    best val IR: 0.12177480713852395
Step: 8000,    val PPL: 1045.983154296875,     best val PPL: 937.6535034179688,    best val loss: 89.72856140136719
Step: 8000,    val IR: 0.12417293486531025,    best val IR: 0.12417293486531025
Step: 8500,    val PPL: 1030.55517578125,     best val PPL: 924.4798583984375,    best val loss: 89.602783203125
Step: 8500,    val IR: 0.12790736870491498,    best val IR: 0.12790736870491498
Step: 9000,    val PPL: 1013.2474365234375,     best val PPL: 912.0386962890625,    best val loss: 89.51284790039062
Step: 9000,    val IR: 0.13057998093055082,    best val IR: 0.13057998093055082
Step: 9500,    val PPL: 949.554931640625,     best val PPL: 866.716552734375,    best val loss: 89.06148529052734
Step: 9500,    val IR: 0.1342638518361574,    best val IR: 0.1342638518361574
Step: 10000,    val PPL: 906.8057861328125,     best val PPL: 825.5538330078125,    best val loss: 88.68724060058594
Step: 10000,    val IR: 0.1355664493263095,    best val IR: 0.1355664493263095
Step: 10000,    test PPL: 1409.783935546875,    best test PPL: 1409.783935546875,    best test loss: 89.38314819335938
Step: 10500,    val PPL: 926.4615478515625,     best val PPL: 791.435302734375,    best val loss: 88.26710510253906
Step: 10500,    val IR: 0.13960426076990537,    best val IR: 0.13960426076990537
Step: 11000,    val PPL: 835.7728271484375,     best val PPL: 791.435302734375,    best val loss: 88.26710510253906
Step: 11000,    val IR: 0.1410513237857677,    best val IR: 0.1410513237857677
Step: 11500,    val PPL: 819.1964111328125,     best val PPL: 771.8187866210938,    best val loss: 88.22075653076172
Step: 11500,    val IR: 0.14567422060848875,    best val IR: 0.14567422060848875
Step: 12000,    val PPL: 799.4879760742188,     best val PPL: 740.81982421875,    best val loss: 87.63605499267578
Step: 12000,    val IR: 0.1462689370226624,    best val IR: 0.1462689370226624
Step: 12500,    val PPL: 794.6904296875,     best val PPL: 719.1649169921875,    best val loss: 87.1097412109375
Step: 12500,    val IR: 0.1472368560449191,    best val IR: 0.1472368560449191
Step: 13000,    val PPL: 783.5510864257812,     best val PPL: 698.49658203125,    best val loss: 86.64117431640625
Step: 13000,    val IR: 0.14929308202752628,    best val IR: 0.14929308202752628
Step: 13500,    val PPL: 787.66162109375,     best val PPL: 678.0767211914062,    best val loss: 86.31456756591797
Step: 13500,    val IR: 0.1480723483352756,    best val IR: 0.14929308202752628
Step: 14000,    val PPL: 757.4955444335938,     best val PPL: 654.7447509765625,    best val loss: 85.86935424804688
Step: 14000,    val IR: 0.14928585875123987,    best val IR: 0.14929308202752628
Step: 14500,    val PPL: 765.949462890625,     best val PPL: 635.567626953125,    best val loss: 85.32440185546875
Step: 14500,    val IR: 0.15145284163689077,    best val IR: 0.15145284163689077
Step: 15000,    val PPL: 753.3441772460938,     best val PPL: 615.4750366210938,    best val loss: 84.82518005371094
Step: 15000,    val IR: 0.15136616232146508,    best val IR: 0.15145284163689077
Step: 15500,    val PPL: 728.1277465820312,     best val PPL: 599.074951171875,    best val loss: 84.41484069824219
Step: 15500,    val IR: 0.15281081757856496,    best val IR: 0.15281081757856496
Step: 16000,    val PPL: 762.8902587890625,     best val PPL: 582.4124145507812,    best val loss: 83.86870574951172
Step: 16000,    val IR: 0.1527626624033288,    best val IR: 0.15281081757856496
Step: 16500,    val PPL: 713.8377075195312,     best val PPL: 566.3375244140625,    best val loss: 83.3873291015625
Step: 16500,    val IR: 0.15327792277836103,    best val IR: 0.15327792277836103
Step: 17000,    val PPL: 730.9794921875,     best val PPL: 553.8486938476562,    best val loss: 83.08248901367188
Step: 17000,    val IR: 0.1521510916778226,    best val IR: 0.15327792277836103
Step: 17500,    val PPL: 740.2637329101562,     best val PPL: 536.3734741210938,    best val loss: 82.60804748535156
Step: 17500,    val IR: 0.15438549180880515,    best val IR: 0.15438549180880515
Step: 18000,    val PPL: 719.2073974609375,     best val PPL: 521.7073974609375,    best val loss: 82.14439392089844
Step: 18000,    val IR: 0.15439512284385248,    best val IR: 0.15439512284385248
Step: 18500,    val PPL: 709.5364990234375,     best val PPL: 511.06842041015625,    best val loss: 81.76277160644531
Step: 18500,    val IR: 0.15626113588427398,    best val IR: 0.15626113588427398
Step: 19000,    val PPL: 678.8128662109375,     best val PPL: 492.67462158203125,    best val loss: 81.32609558105469
Step: 19000,    val IR: 0.1545973745798463,    best val IR: 0.15626113588427398
Step: 19500,    val PPL: 710.5471801757812,     best val PPL: 474.1966552734375,    best val loss: 80.78336334228516
Step: 19500,    val IR: 0.1568269591933049,    best val IR: 0.1568269591933049
Step: 20000,    val PPL: 692.8702392578125,     best val PPL: 457.6954345703125,    best val loss: 80.23063659667969
Step: 20000,    val IR: 0.15537989617744238,    best val IR: 0.1568269591933049
Step: 20000,    test PPL: 1862.21630859375,    best test PPL: 1409.783935546875,    best test loss: 89.38314819335938
Step: 20500,    val PPL: 760.4444580078125,     best val PPL: 443.0240478515625,    best val loss: 79.6670150756836
Step: 20500,    val IR: 0.15779487821556218,    best val IR: 0.15779487821556218
Step: 21000,    val PPL: 684.2562255859375,     best val PPL: 443.0240478515625,    best val loss: 79.6670150756836
Step: 21000,    val IR: 0.15800435322784154,    best val IR: 0.15800435322784154
Step: 21500,    val PPL: 707.8390502929688,     best val PPL: 443.0240478515625,    best val loss: 79.6670150756836
Step: 21500,    val IR: 0.15979331798788454,    best val IR: 0.15979331798788454
Step: 22000,    val PPL: 701.7413940429688,     best val PPL: 430.8406982421875,    best val loss: 79.22090148925781
Step: 22000,    val IR: 0.15952846452408265,    best val IR: 0.15979331798788454
Step: 22500,    val PPL: 685.3230590820312,     best val PPL: 416.15789794921875,    best val loss: 78.7325439453125
Step: 22500,    val IR: 0.16299804489988576,    best val IR: 0.16299804489988576
Step: 23000,    val PPL: 681.5596923828125,     best val PPL: 404.8165283203125,    best val loss: 78.30618286132812
Step: 23000,    val IR: 0.16225163968371664,    best val IR: 0.16299804489988576
Step: 23500,    val PPL: 670.9010009765625,     best val PPL: 389.20745849609375,    best val loss: 77.70738983154297
Step: 23500,    val IR: 0.15882780672438895,    best val IR: 0.16299804489988576
Step: 24000,    val PPL: 655.3338623046875,     best val PPL: 379.38623046875,    best val loss: 77.29542541503906
Step: 24000,    val IR: 0.1605734318267188,    best val IR: 0.16299804489988576
Step: 24500,    val PPL: 630.8226318359375,     best val PPL: 368.17083740234375,    best val loss: 76.87530517578125
Step: 24500,    val IR: 0.16069381976480998,    best val IR: 0.16299804489988576
Step: 25000,    val PPL: 670.9932861328125,     best val PPL: 355.62969970703125,    best val loss: 76.33940124511719
Step: 25000,    val IR: 0.16012318093825542,    best val IR: 0.16299804489988576
Step: 25500,    val PPL: 677.29541015625,     best val PPL: 346.6428527832031,    best val loss: 75.9710693359375
Step: 25500,    val IR: 0.1623455422754279,    best val IR: 0.16299804489988576
Step: 26000,    val PPL: 669.2236938476562,     best val PPL: 338.72161865234375,    best val loss: 75.67124938964844
Step: 26000,    val IR: 0.16220830002600364,    best val IR: 0.16299804489988576
Step: 26500,    val PPL: 655.43505859375,     best val PPL: 327.9095458984375,    best val loss: 75.18354797363281
Step: 26500,    val IR: 0.16521077520201138,    best val IR: 0.16521077520201138
Step: 27000,    val PPL: 672.6063232421875,     best val PPL: 320.3426513671875,    best val loss: 75.0171127319336
Step: 27000,    val IR: 0.1672525546320467,    best val IR: 0.1672525546320467
Step: 27500,    val PPL: 685.3831787109375,     best val PPL: 308.8076171875,    best val loss: 74.44075012207031
Step: 27500,    val IR: 0.1649049898392579,    best val IR: 0.1672525546320467
Step: 28000,    val PPL: 643.289306640625,     best val PPL: 300.68017578125,    best val loss: 74.01631164550781
Step: 28000,    val IR: 0.16555267694619147,    best val IR: 0.1672525546320467
Step: 28500,    val PPL: 672.5498046875,     best val PPL: 292.14727783203125,    best val loss: 73.63259887695312
Step: 28500,    val IR: 0.16232387244657207,    best val IR: 0.1672525546320467
Step: 29000,    val PPL: 646.839599609375,     best val PPL: 287.68756103515625,    best val loss: 73.43917846679688
Step: 29000,    val IR: 0.16359757683158246,    best val IR: 0.1672525546320467
Step: 29500,    val PPL: 654.5343017578125,     best val PPL: 281.0461120605469,    best val loss: 73.132568359375
Step: 29500,    val IR: 0.1627909776463678,    best val IR: 0.1672525546320467
Step: 30000,    val PPL: 651.4183959960938,     best val PPL: 276.3397216796875,    best val loss: 72.96551513671875
Step: 30000,    val IR: 0.1644354768807008,    best val IR: 0.1672525546320467
Step: 30000,    test PPL: 2401.87744140625,    best test PPL: 1409.783935546875,    best test loss: 89.38314819335938
Step: 30500,    val PPL: 722.5599975585938,     best val PPL: 266.3759765625,    best val loss: 72.357666015625
Step: 30500,    val IR: 0.1635205285512037,    best val IR: 0.1672525546320467
Step: 31000,    val PPL: 654.5938720703125,     best val PPL: 266.3759765625,    best val loss: 72.357666015625
Step: 31000,    val IR: 0.16666746925292103,    best val IR: 0.1672525546320467
Step: 31500,    val PPL: 656.561767578125,     best val PPL: 266.3759765625,    best val loss: 72.357666015625
Step: 31500,    val IR: 0.1659018019666576,    best val IR: 0.1672525546320467
Step: 32000,    val PPL: 632.7099609375,     best val PPL: 266.3759765625,    best val loss: 72.357666015625
Step: 32000,    val IR: 0.1664483632055939,    best val IR: 0.1672525546320467
Step: 32500,    val PPL: 640.5996704101562,     best val PPL: 256.3724365234375,    best val loss: 71.72317504882812
Step: 32500,    val IR: 0.16546599763076533,    best val IR: 0.1672525546320467
Step: 33000,    val PPL: 640.0831298828125,     best val PPL: 251.95301818847656,    best val loss: 71.59066772460938
Step: 33000,    val IR: 0.1641609923818515,    best val IR: 0.1672525546320467
Step: 33500,    val PPL: 640.8951416015625,     best val PPL: 246.6067657470703,    best val loss: 71.2750244140625
Step: 33500,    val IR: 0.16728867101347367,    best val IR: 0.16728867101347367
Step: 34000,    val PPL: 637.4041748046875,     best val PPL: 241.67404174804688,    best val loss: 71.0751953125
Step: 34000,    val IR: 0.1661425778428409,    best val IR: 0.16728867101347367
Step: 34500,    val PPL: 647.6448974609375,     best val PPL: 237.983642578125,    best val loss: 70.77224731445312
Step: 34500,    val IR: 0.1682662210707784,    best val IR: 0.1682662210707784
Step: 35000,    val PPL: 691.7327880859375,     best val PPL: 229.89718627929688,    best val loss: 70.3331527709961
Step: 35000,    val IR: 0.1676739124153675,    best val IR: 0.1682662210707784
Step: 35500,    val PPL: 641.6624755859375,     best val PPL: 226.25064086914062,    best val loss: 70.12098693847656
Step: 35500,    val IR: 0.16743072878042242,    best val IR: 0.1682662210707784
Step: 36000,    val PPL: 657.115966796875,     best val PPL: 222.31793212890625,    best val loss: 69.88212585449219
Step: 36000,    val IR: 0.16484720362897415,    best val IR: 0.1682662210707784
Step: 36500,    val PPL: 641.3530883789062,     best val PPL: 216.63540649414062,    best val loss: 69.5957260131836
Step: 36500,    val IR: 0.16692991495796075,    best val IR: 0.1682662210707784
Step: 37000,    val PPL: 635.3472900390625,     best val PPL: 211.20957946777344,    best val loss: 69.24723052978516
Step: 37000,    val IR: 0.16681675029615423,    best val IR: 0.1682662210707784
Step: 37500,    val PPL: 671.23291015625,     best val PPL: 208.1536102294922,    best val loss: 68.96250915527344
Step: 37500,    val IR: 0.1661281312902697,    best val IR: 0.1682662210707784
Step: 38000,    val PPL: 650.7021484375,     best val PPL: 204.10643005371094,    best val loss: 68.64015197753906
Step: 38000,    val IR: 0.16500852346601694,    best val IR: 0.1682662210707784
Step: 38500,    val PPL: 651.3450927734375,     best val PPL: 199.58230590820312,    best val loss: 68.42420959472656
Step: 38500,    val IR: 0.16480867948878475,    best val IR: 0.1682662210707784
Step: 39000,    val PPL: 665.51904296875,     best val PPL: 197.8582763671875,    best val loss: 68.329345703125
Step: 39000,    val IR: 0.16706474944862335,    best val IR: 0.1682662210707784
Step: 39500,    val PPL: 665.1885986328125,     best val PPL: 194.01123046875,    best val loss: 68.02470397949219
Step: 39500,    val IR: 0.167490922749468,    best val IR: 0.1682662210707784
Step: 40000,    val PPL: 653.9005126953125,     best val PPL: 190.25064086914062,    best val loss: 67.76499938964844
Step: 40000,    val IR: 0.16461124327031468,    best val IR: 0.1682662210707784
Step: 40000,    test PPL: 4556.05078125,    best test PPL: 1409.783935546875,    best test loss: 89.38314819335938
Step: 40500,    val PPL: 699.87451171875,     best val PPL: 190.25064086914062,    best val loss: 67.76499938964844
Step: 40500,    val IR: 0.169031888357042,    best val IR: 0.169031888357042
Step: 41000,    val PPL: 637.9837646484375,     best val PPL: 190.25064086914062,    best val loss: 67.76499938964844
Step: 41000,    val IR: 0.16867554006029062,    best val IR: 0.169031888357042
Step: 41500,    val PPL: 646.775390625,     best val PPL: 190.25064086914062,    best val loss: 67.76499938964844
Step: 41500,    val IR: 0.16552137608228765,    best val IR: 0.169031888357042
Step: 42000,    val PPL: 638.0513305664062,     best val PPL: 189.283935546875,    best val loss: 67.74662780761719
Step: 42000,    val IR: 0.16712012790014563,    best val IR: 0.169031888357042
Step: 42500,    val PPL: 627.577392578125,     best val PPL: 184.0797576904297,    best val loss: 67.28367614746094
Step: 42500,    val IR: 0.16619554853560134,    best val IR: 0.169031888357042
Step: 43000,    val PPL: 657.5997924804688,     best val PPL: 181.9542999267578,    best val loss: 67.15008544921875
Step: 43000,    val IR: 0.16738016584642373,    best val IR: 0.169031888357042
Step: 43500,    val PPL: 614.340576171875,     best val PPL: 179.11541748046875,    best val loss: 66.88430786132812
Step: 43500,    val IR: 0.16733923394747255,    best val IR: 0.169031888357042
Step: 44000,    val PPL: 644.6309814453125,     best val PPL: 173.65621948242188,    best val loss: 66.60957336425781
Step: 44000,    val IR: 0.1672405158382372,    best val IR: 0.169031888357042
Step: 44500,    val PPL: 637.1260986328125,     best val PPL: 171.54684448242188,    best val loss: 66.35720825195312
Step: 44500,    val IR: 0.16687694426520064,    best val IR: 0.169031888357042
Step: 45000,    val PPL: 645.497314453125,     best val PPL: 168.49681091308594,    best val loss: 66.14736938476562
Step: 45000,    val IR: 0.16626055802217085,    best val IR: 0.169031888357042
Step: 45500,    val PPL: 642.65576171875,     best val PPL: 166.25558471679688,    best val loss: 65.94842529296875
Step: 45500,    val IR: 0.16780393138850697,    best val IR: 0.169031888357042
Step: 46000,    val PPL: 634.8916015625,     best val PPL: 164.1090087890625,    best val loss: 65.8525390625
Step: 46000,    val IR: 0.1672814477371883,    best val IR: 0.169031888357042
Step: 46500,    val PPL: 649.1737060546875,     best val PPL: 161.15097045898438,    best val loss: 65.65091705322266
Step: 46500,    val IR: 0.16739461239899478,    best val IR: 0.169031888357042
Step: 47000,    val PPL: 641.5057373046875,     best val PPL: 160.76759338378906,    best val loss: 65.63320922851562
Step: 47000,    val IR: 0.1691643150889427,    best val IR: 0.1691643150889427
Step: 47500,    val PPL: 638.5823974609375,     best val PPL: 156.60403442382812,    best val loss: 65.26718139648438
Step: 47500,    val IR: 0.16912338318999168,    best val IR: 0.1691643150889427
Step: 48000,    val PPL: 626.968994140625,     best val PPL: 155.83956909179688,    best val loss: 65.23971557617188
Step: 48000,    val IR: 0.16876944265200197,    best val IR: 0.1691643150889427
Step: 48500,    val PPL: 669.6232299804688,     best val PPL: 153.72763061523438,    best val loss: 64.88107299804688
Step: 48500,    val IR: 0.16808082364611737,    best val IR: 0.1691643150889427
Step: 49000,    val PPL: 632.7081298828125,     best val PPL: 152.0703582763672,    best val loss: 64.88107299804688
Step: 49000,    val IR: 0.1656899191956162,    best val IR: 0.1691643150889427
Step: 49500,    val PPL: 631.9244384765625,     best val PPL: 150.68646240234375,    best val loss: 64.70297241210938
Step: 49500,    val IR: 0.16778226155965006,    best val IR: 0.1691643150889427
Step: 50000,    val PPL: 614.695556640625,     best val PPL: 148.25889587402344,    best val loss: 64.63677978515625
Step: 50000,    val IR: 0.16588494765532477,    best val IR: 0.1691643150889427
Step: 50000,    test PPL: 10107.44140625,    best test PPL: 1409.783935546875,    best test loss: 89.38314819335938
